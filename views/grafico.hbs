<!DOCTYPE html>
<html lang="it">
<head>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js" charset="utf-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.0/handlebars.js"></script>
    <script src="node_modules/chart.js/src/chart.js"></script>
    <script src="/public/js/bootstrap.js"></script>
    <script src="/public/js/fusioncharts.js"></script>
    <script src="/public/js/fusioncharts.charts.js"></script>
    <script src="/public/js/fusioncharts.theme.zune.js"></script>
<script>
    var chartData;

    $(function(){
        $.ajax({

            url: 'https://homebanking-app.herokuapp.com/grafico',

            type: 'GET',
            success : function(data) {
                chartData = data;
                var template = Handlebars.compile($("#tabular-template").html());
                $("#table-location").html(template(data));

                var chartProperties = {
                    "caption": "Situazione bancaria",
                    "numberprefix": "â‚¬",
                    "xAxisName": "Mese",
                    "yAxisName": "Importo"
                };

                var categoriesArray = [{
                    "category" : data["categories"]
                }];

                var lineChart = new FusionCharts({
                    type: 'msline',
                    renderAt: 'chart-location',
                    width: '1000',
                    height: '600',
                    dataFormat: 'json',
                    dataSource: {
                        chart: chartProperties,
                        categories : categoriesArray,
                        dataset : data["dataset"]
                    }
                });
                lineChart.render();
            }
        });
    });
</script>




</head>

<body>

<div id="table-location">

</div>
<br/>

<div id="chart-location">
    <div class="se-pre-con"></div>
</div>
<script id="tabular-template" type="text/html">
    <h2>Tabella movimenti</h2>
    <table class="table table-bordered">
        <thead>
        <tr>
            <td><b>Mesi</b></td>
            \{{#each categories}} <td>\{{label}}</td> \{{/each }}
        </tr>
        </thead>
        <tbody>
        \{{#each dataset}}
        <tr>
            <td><b>Importo</b></td>
            \{{#each data}} <td>\{{value}}</td> \{{/each}}
        </tr>
        \{{/each}}
        </tbody>
    </table>
</script>

</body>
</html>
</html>